### 编译器原理

编程语言本质上只是一个软件，这个软件叫做编译器，编译器读入一个文本文件，经过大量的处理，最终产生一个二进制文件。编译器可以是任何可以把文本文件
转换成其他文件的程序。

简言之，编译器获取源代码，产生一个二进制文件。因为从复杂的、人类可读的代码直接转化成0/1二进制会很复杂，所以编译器在产生可运行程序之前有多个步骤：

1.  从给定的源代码中读取单个词。
2.  把这些词按照单词、数字、符号、运算符进行分类。
3.  通过模式匹配从分好类的单词中找出运算符，明确这些运算符想进行的运算，然后产生一个运算符的树（表达式树）。
4.  最后一步遍历表达式树中的所有运算符，产生相应的二进制数据。

尽管以上说的编译器直接从表达式树转换到二进制，但实际上它会产生汇编代码，之后汇编代码会被汇编/编译到二进制数据。汇编程序就好比是一种高级的、人类
可读的二进制。

![WX20181214-183209.png](static/WX20181214-183209.png)


**解释器又是什么？**

解释器非常像编译器，它也是读入编程语言的代码，然后处理这些代码。尽管如此，解释器会跳过了代码生成，然后即时编译并执行 AST。 解释器最大的优点就在
于在 debug 期间运行程序所消耗的时间。编译器编译一个程序可能在一秒到几分钟不等，然而解释器可以立即开始执行程序，而不必编译。解释器最大的缺点在
于它必须安装在用户电脑上，程序才可以执行。

![WX20181214-183749.png](static/WX20181214-183749.png)

#### 词法分析

第一步是把输入一个词一个词地拆分开，这一步被叫做`词法分析`，又叫`分词`。这一步的关键就在于把字符组合成需要的单词、标识符、符号等等。以下是一个
最简单的分词器。

[lexer.go](lexer.go)

在一种编程语言的编译器中，词法解析器可能需要许多不同类型的标记。例如：符号、数字、标识符、字符串、操作符等等。想要从源文件中撮怎样的标记完全取决
于编程语言本身。

#### 解析

解析器确实是语法解析的核心。解析器撮由词法分析器产生的标记，并尝试判断它们是否符合特定的模式，然后把这些模式与函数调用、变量调用、数学运算之类的
表达式关联起来。解析器逐词地定义编程语言的语法，当票房不符合预期的模式时，解析器就会知道标记的顺序不正确。

解析器在解析时产生的树状结构被称为抽象的语法树，或者称为 AST。AST 中包含了所有要进行的操作。解析器不会计算这些操作，它只是以正确的顺序来收集其
中的标记。